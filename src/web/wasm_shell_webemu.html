<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>webemu</title>
    <meta name="viewport" content="width=device-width" />
    <link rel="stylesheet" href="style.css" />
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.31.1/min/vs/editor/editor.main.min.css"
        integrity="sha512-3kaW6VOMaj21NqrAUic4boSfhoP6drJ9bS4csFwvS11HlpL4DyS1QPm0GsAHK2yQGeBFRFi+LVK9uadFIA22Lg=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer" />
  </head>
  <body>
    <div class="controll-bar">
      <input type="button" value="Load Memory and Program" id="prog_init" />
      Memory: <input type="text" size="3" id="mem_start" value="0x34" />--<input type="text" size="3" id="mem_end" value="0x40" /><input type="button" value="Set Range" id="set_range" />
      <input type="button" value="Reverse Next (←)" id="reverse_clock" />
      <input type="button" value="Next Clock (→)" id="clock" />
      <input type="button" value="Continue" id="continue" />
      <input type="button" value="Copy Assembled Program" id="copy_prog_mem" />
      <input type="button" value="Download Memory as C Source Code" id="download_mem_c" />
      <div class="error-bar" id="err"></div>
    </div>

    <div class="doc-notification">
      Documentation available (Japanese).
      <a href="https://www.kofuk.org/blog/20220131-emulator/">Visit</a>
    </div>

    <div class="container">
      <div class="source-pane pane">
        <form class="editor-tab-selector">
          <input type="radio" id="editor_prog" name="editor-tab" checked /><label for="editor_prog">Program</label><input type="radio" id="editor_mem" name="editor-tab" /><label for="editor_mem">Memory</label>
        </form>
        <div id="prog_editor" style="width: 100%; height: 600px; border: 1px solid grey"></div>
      </div>
      <div class="run-pane pane">
        <div id="status" class="status-bar"></div>

        <div>
          Estimated Clock Count: <span id="clock_count">0</span>
          <div class="tip">
            <strong>DISCLAIMER</strong>: The estimated clock may be inaccurate
            because the emulator doesn't run pipelined processing internally.
          </div>
        </div>

        <div>
          Register:
          <table border="1">
            <thead>
              <tr>
                <th>r0</th>
                <th>r1</th>
                <th>r2</th>
                <th>r3</th>
                <th>r4</th>
                <th>r5</th>
                <th>r6</th>
                <th>r7</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td><input type="text" size="3" id="reg0" /></td>
                <td><input type="text" size="3" id="reg1" /></td>
                <td><input type="text" size="3" id="reg2" /></td>
                <td><input type="text" size="3" id="reg3" /></td>
                <td><input type="text" size="3" id="reg4" /></td>
                <td><input type="text" size="3" id="reg5" /></td>
                <td><input type="text" size="3" id="reg6" /></td>
                <td><input type="text" size="3" id="reg7" /></td>
              </tr>
            </tbody>
          </table>
          <input type="button" value="Apply Changes" id="apply_reg" />
        </div>

        <div>
          Memory:
          <table border="1">
            <thead>
              <tr>
                <th></th>
                <th>x0<br>x8</th>
                <th>x1<br>x9</th>
                <th>x2<br>xa</th>
                <th>x3<br>xb</th>
                <th>x4<br>xc</th>
                <th>x5<br>xd</th>
                <th>x6<br>xe</th>
                <th>x7<br>xf</th>
              </tr>
            </thead>
            <tbody id="mem_table_body">
            </tbody>
          </table>
          <input type="button" value="Apply Changes" id="apply_mem" />
        </div>

        <div>
          Trace:
          <table border="1" class="trace-table">
            <thead>
              <tr>
                <th>Break</th>
                <th>Instruction</th>
              </tr>
            </thead>
            <tbody id="trace_body"></tbody>
          </table>
        </div>
      </div>
      <div class="breakpoint-pane pane">
        Breakpoints:
        <table border="1" class="breakpoint-table">
            <thead>
              <tr>
                <th></th>
                <th>Condition</th>
              </tr>
            </thead>
            <tbody id="breakpoint_table_body"></tbody>
        </table>
      </div>
    </div>
    <div>
      <a href="https://github.com/kofuk/exasm">View Source Code on GitHub</a>
    </div>

      <script>
       var Module = {
           preRun: [],
           postRun: [],
           print: function(text) {
               console.log(text);
           },
           printErr: function(text) {
               appendError(text);
           },
           setStatus: function(text) {
               if (text) console.log(text);
           },
       };

       var require = {
           paths: {
               vs: 'https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.31.1/min/vs'
           },
           'vs/nls': {
			   availableLanguages: {
				   '*': 'ja'
			   }
		   }
       };
      </script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.31.1/min/vs/loader.min.js"
        integrity="sha512-Ffp6rxgxoBVdIqZjh+sswQIpL3Beu1BhlmisLpAZuO/8ENWpZjmjktp7w4WsaB2fgj2Tq/Sf5plViG2qJpivog=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"></script>
    <script
        src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.31.1/min/vs/editor/editor.main.min.js"
        integrity="sha512-WonfuZ3g7wNOB0wnPwdCJkcg4LQB1XwVpbZRBxn++nCdhsTtjGDvzekEUrt76A0Ef6DD0KVc7FfWmqn0dS7vTA=="
        crossorigin="anonymous"
        referrerpolicy="no-referrer"></script>
    <script src="driver.js"></script>
    {{{ SCRIPT }}}
  </body>
</html>
